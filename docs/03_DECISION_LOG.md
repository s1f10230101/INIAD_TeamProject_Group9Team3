目的: 「なぜこの技術を選んだのか？」という過去の意思決定の経緯を記録する (ADR: Architecture Decision Record)。
# 意思決定の記録 (Architecture Decision Record)
---


## 8/31: Gherkinのドキュメント記法のみを採用
- **ステータス**: 未決定
- **背景情報**
  - テスト仕様をAIに依頼し、長大なGoテストコードを生成している
  - しかし、現状の手法には以下の問題がある
    - コードは冗長で人間が読めず、根拠が不透明
    - 「このテストはどの仕様から来たのか？」が曖昧で保守性が低い

* **検討した選択肢:**
  - Gherkinのドキュメント記法を採用する
    - 「Given, When, Then」固定された形式でテスト仕様を書く
    - それをAIに渡してテストコードを生成する
    - 人間が読める、根拠が明確、保守性が高い
    - Gherkinとテストコードの同一性はAIが保証する
  - テスト仕様はGoテストコードで表現
    - 今まで通り
    - 読みにくい、保守が大変
    - シンプル
  - Godog+Ginkgoフレームワークを採用する
    - Gherkinのドキュメント記法の一貫性をGoで保証できる
    - Go標準と乖離し、二重管理、学習コストが発生する

* **決定理由:**
  - Spec-Driven Development (SDD) を導入する。
    - 人間はGherkinの仕様（Given/When/Then） を記述する。
    - AIを「コンパイラ」として用い、仕様からGoのテストコードを生成する。
    - 結果はリポジトリにコミットし、仕様⇔テストの対応を差分管理する。
    - テスト実行は従来通り go test で行い、ランタイム依存を追加しない。
---

## 8/31: typespecでOpenAPI仕様を定義
- **ステータス**: 未決定
- **背景情報**
  - 今までOpenAPI仕様を手書きで書いていたが、保守が大変だった

* **検討した選択肢:**
  - 手書き(AI)でOpenAPI仕様を書く
    - 今まで通り
    - 読みにくい、保守が大変
  - typespecでOpenAPI仕様を書く
    - TypeSpecを使ってOpenAPI仕様を生成する
    - typescript似で比較的読みやすい
  - stoplight studioでOpenAPI仕様を書く
    - GUIでOpenAPI仕様を生成できる
    - Gitに保存されない
* **決定理由:**
  - typespecでOpenAPI仕様を書くことにより、保守が楽になると考えたため
---

## 8/21: OpenAPI型ジェネレータにoapi-codegenを採用
- **ステータス**: 仮決定
- **背景情報**
  - OpenAPI仕様からGoコードを自動生成するツールを決めたかった

* **検討した選択肢:**
  - oapi-codegen
    - OpenAPI 3.0に対応
    - Goの標準的なコードを生成
    - 活発にメンテナンスされている
  - ogen
    - OpenAPI 3.1に対応
    - 高速で型安全なコードを生成
    - メンテナンスがあまり活発ではない
  - go-swagger
    - OpenAPI 2.0に対応
    - 古いツールであり、最新のOpenAPI仕様に対応していない
* **決定理由:**
  - oapi-codegenはとりあえず標準的な選択肢
  - 早く実装に移って試せることを優先

* **結果 (あれば):**
---

## 8/21: バックエンドの言語にGoを採用
- **ステータス**: 決定
- **背景情報**
  - バックエンドの言語を何にするか決める必要があった
  - 全体4人チームでフロントとバックに分かれる都合上、OpenAPIスキーマ駆動開発を採用したい事情があった

* **検討した選択肢:**
  - Django (Python)
    - 学校で必ず習うフルスタックフレームワーク
    - バックエンドとして使うことも可能だが、他の選択肢と比べて優れる点はなくデフォルトのOpenAPI対応は存在しない
  - FastAPI (Python)
    - Python製のモダンなWebAPIフレームワーク
    - PythonのAIライブラリとの親和性が高い
    - easyな設計で初期学習コストは低い
    - 実装からOpenAPIスキーマを自動生成できる。しかし今回はスキーマから実装を生成するのが望ましい
  - Go (Golang)
    - Google製のモダンなシステム言語
    - OpenAPIスキーマからGoコードを自動生成できるoapi-codegen,ogenが存在する
    - easyよりsimple & 標準ライブラリが充実で、外部ライブラリの学習コストが不要

* **決定理由:**
  - Pythonばかり使ってたまには違う言語を使いたいという気持ちがあったこと
  - FastAPIのeasy(NOT simple)な特性が我々に合わない、のちのち苦労しそう
---

## [日にち]: 決定事項
- **ステータス**: [決定 or 未決定]

- **背景情報**

* **検討した選択肢:**

* **決定理由:**

* **結果 (あれば):**
